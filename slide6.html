<section class="business-impact-slide" data-auto-animate data-transition="zoom">
  <style>
    .business-impact-slide {
      position: relative;
      background: #ffffff;
      width: 100%;
      height: 100%;
      padding: 1vh 2vw;
      box-sizing: border-box;
      overflow: hidden;
      font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont,
        sans-serif;
      --primary-blue: #2563eb;
      --light-blue: #60a5fa;
      --primary-orange: #f97316;
      --light-orange: #fb923c;
      --card-bg: #f8fafc;
      --text-dark: #1e293b;
      --text-light: #64748b;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
        0 4px 6px -4px rgba(0, 0, 0, 0.1);
    }

    .business-impact-slide * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .business-impact-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
    }


    .company-logo {
      height: 30px;
      max-width: 30px;
    }

    .slide-subtitle {
      color: var(--text-light);
      font-size: 0.7rem;
      font-weight: 400;
      text-align: center;
      margin-bottom: 3px;
    }
    
    .main-content h2 {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary-blue);
      text-align: center;
      margin: 10px 0;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 20;
    }

    .main-content {
      flex: 1;
      display: flex;
      position: relative;
      flex-direction: column;
      overflow: hidden;
    }

    /* Dashboard grid layout */
    .dashboard-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      height: 100%;
      padding: 0 0.3rem;
    }

    /* First row: 3 cards */
    .top-row {
      display: flex;
      justify-content: center;
      gap: 0.6rem;
      margin-bottom: 0.6rem;
      width: 100%;
    }

    /* Second row: 2 cards centered */
    .bottom-row {
      display: flex;
      justify-content: center;
      gap: 0.6rem;
      width: 100%;
    }

    .metric-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
      width: 300px; /* Fixed width */
      height: 170px; /* Fixed height */
    }

    .metric-header {
      display: flex;
      align-items: center;
      margin-bottom: 0.3rem;
      position: relative;
      z-index: 1;
    }

    .icon-5container {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.4rem;
      background: linear-gradient(
        135deg,
        var(--primary-blue),
        var(--light-blue)
      );
      flex-shrink: 0;
    }

    .metric-card:nth-child(even) .icon-5container {
      background: linear-gradient(
        135deg,
        var(--primary-orange),
        var(--light-orange)
      );
    }

    .icon-5container svg {
      width: 14px;
      height: 14px;
      fill: none;
      stroke: white;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .metric-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-dark);
    }

    .metric-subtitle {
      font-size: 12px;
      color: var(--text-light);
    }

    .metric-value {
      font-size: 16px;
      font-weight: 700;
      margin: 0.3rem 0;
      color: var(--text-dark);
      position: relative;
      z-index: 1;
    }

    .metric-value span {
      background: linear-gradient(
        90deg,
        var(--primary-blue),
        var(--primary-orange)
      );
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Advanced chart styling */
    .chart-container {
      position: relative;
      margin-top: 0.3rem;
    }

    .progress-ring-container {
      position: relative;
      width: 50px;
      height: 50px;
      margin: 0 auto;
    }

    .progress-ring {
      transform: rotate(-90deg);
      width: 100%;
      height: 100%;
    }

    .progress-ring-circle {
      fill: transparent;
      stroke-width: 5;
      stroke-linecap: round;
      stroke: #e2e8f0;
    }

    .progress-ring-circle-value {
      fill: transparent;
      stroke-width: 5;
      stroke-linecap: round;
      stroke: url(#gradient-1);
      transition: none;
      /* The dasharray and dashoffset will be set via JavaScript */
    }
    
    /* Class to apply animation when fragment is visible */
    .progress-ring-circle-value {
      transition: stroke-dashoffset 1.5s ease-out;
    }
    
    .progress-ring-circle-value.animate {
      animation: progress-animation 1.5s ease-out forwards;
    }

    @keyframes progress-animation {
      0% {
        stroke-dashoffset: 125.6; /* Full circumference (0% filled) */
      }
      100% {
        stroke-dashoffset: var(--target-offset); /* Animate to target value */
      }
    }

    .progress-percentage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--text-dark);
      animation: count-up 1.5s ease-out forwards;
    }

    @keyframes count-up {
      0% {
        content: "0%";
      }
      100% {
        content: attr(data-value);
      }
    }

    /* Multiplier visualization */
    .multiplier-container {
      margin-top: 0.6rem;
      position: relative;
    }

    .multiplier-scale {
      height: 4px;
      background: #e2e8f0;
      border-radius: 2px;
      position: relative;
      margin: 16px 0 8px;
    }

    .multiplier-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      border-radius: 2px;
      background: linear-gradient(
        to right,
        var(--primary-blue),
        var(--primary-orange)
      );
      width: 0;
      transition: width 1.5s ease-out;
      /* Transition added directly */
    }
    
    /* Class to apply animation when fragment is visible */
    .multiplier-progress.animate {
      animation: width-animation 1.5s ease-out forwards;
    }

    @keyframes width-animation {
      0% {
        width: 0%;
      }
      100% {
        width: var(--target-width, 60%);
      }
    }

    .multiplier-markers {
      position: relative;
      display: flex;
      justify-content: space-between;
      margin-top: -12px;
    }

    .multiplier-marker {
      position: relative;
      width: 8px;
      height: 8px;
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 50%;
      z-index: 1;
    }

    .multiplier-marker.active {
      border-color: var(--primary-blue);
      background: white;
      /* No default animation - will be added via JS */
    }
    
    /* Class to apply animation when fragment is visible */
    .multiplier-marker.active.animate {
      animation: marker-active 1.5s ease-out forwards;
    }

    @keyframes marker-active {
      0% {
        border-color: #e2e8f0;
      }
      100% {
        border-color: var(--primary-blue);
      }
    }

    .multiplier-marker.current {
      background: white;
      border-color: #e2e8f0;
      /* No default animation - will be added via JS */
    }
    
    /* Class to apply animation when fragment is visible */
    .multiplier-marker.current.animate {
      animation: marker-current 1.5s ease-out forwards;
    }

    @keyframes marker-current {
      0% {
        background: white;
        border-color: #e2e8f0;
        transform: scale(1);
      }
      100% {
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--primary-orange)
        );
        border-color: white;
        transform: scale(1.2);
      }
    }

    .multiplier-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 4px;
    }

    .multiplier-label {
      font-size: 0.6rem;
      color: var(--text-light);
      font-weight: 500;
    }

    .multiplier-value {
      position: absolute;
      top: -16px;
      left: 60%;
      transform: translateX(-50%);
      background: linear-gradient(
        135deg,
        var(--primary-blue),
        var(--primary-orange)
      );
      color: white;
      padding: 1px 6px;
      border-radius: 6px;
      font-size: 0.6rem;
      font-weight: 600;
      white-space: nowrap;
      opacity: 1; /* Changed from 0 to ensure visibility */
      /* No default animation - will be added via JS */
    }
    
    /* Class to apply animation when fragment is visible */
    .multiplier-value.animate {
      animation: fade-in 1.5s ease-out forwards;
      animation-delay: 0.5s;
    }

    @keyframes fade-in {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    .multiplier-value::after {
      content: "";
      position: absolute;
      bottom: -3px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 3px solid transparent;
      border-right: 3px solid transparent;
      border-top: 3px solid var(--primary-orange);
    }

    /* Counter animation for percentage text */
    .animate-count {
      counter-reset: count 0;
      display: inline-block; /* Ensure the element is visible */
      /* No default animation - will be added via JS */
    }
    
    /* Class to apply animation when fragment is visible */
    .animate-count.animate {
      animation: counter-animation 1.5s forwards ease-out;
    }

    .animate-count::after {
      content: counter(count) "%";
      opacity: 1;
    }

    @keyframes counter-animation {
      0% {
        counter-reset: count 0;
      }
      100% {
        counter-reset: count var(--target-value);
      }
    }

    @media (max-width: 768px) {
      .top-row,
      .bottom-row {
        flex-direction: column;
        align-items: center;
      }

      .metric-card {
        width: 160px;
        height: 150px;
      }
    }
  </style>
  <header class="slide-header" data-id="header">
    <h1 style="visibility: visible !important; opacity: 1 !important; z-index: 20;" class="zoom-in" data-auto-animate data-auto-animate-duration="1.5">
      WELCOME TO FUSEFY
    </h1>
    <img
      src="images/Logo.png"
      alt="Company Logo"
      class="company-logo"
      data-auto-animate
      data-auto-animate-duration="1"
    />
  </header>

    <div class="main-content">
      <h2 class="gradient-text">
        Business Impact Metrics
      </h2>
      <h3 class="slide-subtitle">
        End-to-End AI Adoption for Intelligent Automation
      </h3>
      <div class="dashboard-container">
        <div class="top-row">
          <!-- First row: 3 cards -->
          <div class="metric-card fragment" data-fragment-index="1">
            <div class="metric-header">
              <div class="icon-5container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
              </div>
              <div>
                <div class="metric-title">Manual Task Reduction</div>
                <div class="metric-subtitle">Decrease in manual operations</div>
              </div>
            </div>
            <div class="metric-value"><span>50-60%</span></div>
            <div class="chart-container">
              <div class="progress-ring-container">
                <svg class="progress-ring" width="50" height="50">
                  <circle
                    class="progress-ring-circle"
                    cx="25"
                    cy="25"
                    r="20"
                  ></circle>
                  <circle
                    class="progress-ring-circle-value"
                    cx="25"
                    cy="25"
                    r="20"
                    stroke="url(#gradient-1)"
                    data-target-percent="55"
                    style="--target-offset: 57; stroke-dasharray: 125.6; stroke-dashoffset: 125.6;"
                  ></circle>
                </svg>
                <div class="progress-percentage" style="--target-value: 55">
                  55%
                </div>
              </div>
            </div>
          </div>

          <div class="metric-card fragment" data-fragment-index="2">
            <div class="metric-header">
              <div class="icon-5container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <div>
                <div class="metric-title">Deployment Speed</div>
                <div class="metric-subtitle">
                  Acceleration in implementation
                </div>
              </div>
            </div>
            <div class="metric-value"><span>3x Faster</span></div>
            <div class="chart-container">
              <div class="multiplier-container">
                <div class="multiplier-value" style="opacity: 1; display: block; visibility: visible;">3x Faster</div>
                <div class="multiplier-scale">
                  <div class="multiplier-progress" style="--target-width: 60%;" data-target-position="3"></div>
                </div>
                <div class="multiplier-markers">
                  <div class="multiplier-marker active"></div>
                  <div class="multiplier-marker active"></div>
                  <div class="multiplier-marker current"></div>
                  <div class="multiplier-marker"></div>
                  <div class="multiplier-marker"></div>
                </div>
                <div class="multiplier-labels">
                  <div class="multiplier-label">1x</div>
                  <div class="multiplier-label">2x</div>
                  <div class="multiplier-label">3x</div>
                  <div class="multiplier-label">4x</div>
                  <div class="multiplier-label">5x</div>
                </div>
              </div>
            </div>
          </div>

          <div class="metric-card fragment" data-fragment-index="3">
            <div class="metric-header">
              <div class="icon-5container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <div>
                <div class="metric-title">Resolution Time</div>
                <div class="metric-subtitle">Improvement in issue handling</div>
              </div>
            </div>
            <div class="metric-value"><span>35-40% Faster</span></div>
            <div class="chart-container">
              <div class="progress-ring-container">
                <svg class="progress-ring" width="50" height="50">
                  <circle
                    class="progress-ring-circle"
                    cx="25"
                    cy="25"
                    r="20"
                  ></circle>
                  <circle
                    class="progress-ring-circle-value"
                    cx="25"
                    cy="25"
                    r="20"
                    stroke="url(#gradient-2)"
                    data-target-percent="38"
                    style="--target-offset: 78; stroke-dasharray: 125.6; stroke-dashoffset: 125.6;"
                  ></circle>
                </svg>
                <div class="progress-percentage">
                  38%
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="bottom-row">
          <!-- Second row: 2 cards -->
          <div class="metric-card fragment" data-fragment-index="4">
            <div class="metric-header">
              <div class="icon-5container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                  />
                </svg>
              </div>
              <div>
                <div class="metric-title">SLA Adherence</div>
                <div class="metric-subtitle">Improvement in compliance</div>
              </div>
            </div>
            <div class="metric-value"><span>20-25% Uplift</span></div>
            <div class="chart-container">
              <div class="progress-ring-container">
                <svg class="progress-ring" width="50" height="50">
                  <circle
                    class="progress-ring-circle"
                    cx="25"
                    cy="25"
                    r="20"
                  ></circle>
                  <circle
                    class="progress-ring-circle-value"
                    cx="25"
                    cy="25"
                    r="20"
                    stroke="url(#gradient-3)"
                    data-target-percent="23"
                    style="--target-offset: 97; stroke-dasharray: 125.6; stroke-dashoffset: 125.6;"
                  ></circle>
                </svg>
                <div class="progress-percentage">
                  23%
                </div>
              </div>
            </div>
          </div>

          <div class="metric-card fragment" data-fragment-index="5">
            <div class="metric-header">
              <div class="icon-5container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                  />
                </svg>
              </div>
              <div>
                <div class="metric-title">Cross-Team Productivity</div>
                <div class="metric-subtitle">Efficiency improvement</div>
              </div>
            </div>
            <div class="metric-value"><span>2x-4x Gain</span></div>
            <div class="chart-container">
              <div class="multiplier-container">
                <div class="multiplier-value" style="opacity: 1; display: block; visibility: visible;">3x Average</div>
                <div class="multiplier-scale">
                  <div class="multiplier-progress" style="--target-width: 60%;" data-target-position="3"></div>
                </div>
                <div class="multiplier-markers">
                  <div class="multiplier-marker active"></div>
                  <div class="multiplier-marker active"></div>
                  <div class="multiplier-marker current"></div>
                  <div class="multiplier-marker"></div>
                  <div class="multiplier-marker"></div>
                </div>
                <div class="multiplier-labels">
                  <div class="multiplier-label">1x</div>
                  <div class="multiplier-label">2x</div>
                  <div class="multiplier-label">3x</div>
                  <div class="multiplier-label">4x</div>
                  <div class="multiplier-label">5x</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SVG Gradients -->
    <svg width="0" height="0" style="position: absolute">
      <defs>
        <linearGradient id="gradient-1" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="#2563eb" />
          <stop offset="100%" stop-color="#f97316" />
        </linearGradient>
        <linearGradient id="gradient-2" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="#2563eb" />
          <stop offset="100%" stop-color="#f97316" />
        </linearGradient>
        <linearGradient id="gradient-3" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="#2563eb" />
          <stop offset="100%" stop-color="#f97316" />
        </linearGradient>
      </defs>
    </svg>
    
    <script>
      // Initialize animations only when fragments are shown
      document.addEventListener('DOMContentLoaded', function() {
        // Function to calculate stroke-dashoffset based on percentage
        function calculateOffset(percent, circumference) {
          return circumference - (circumference * percent / 100);
        }
        
        // Calculate the circumference of each progress ring
        const circles = document.querySelectorAll('.progress-ring-circle');
        circles.forEach(circle => {
          const radius = circle.getAttribute('r');
          const circumference = 2 * Math.PI * radius;
          
          // Set the stroke-dasharray to the circumference
          const valueCircle = circle.nextElementSibling;
          if (valueCircle && valueCircle.classList.contains('progress-ring-circle-value')) {
            valueCircle.style.strokeDasharray = `${circumference}`;
            valueCircle.setAttribute('data-circumference', circumference);
            
            // Initially set to full circumference (0% progress)
            valueCircle.style.strokeDashoffset = circumference;
            
            // Store the target percentage
            const targetPercent = valueCircle.getAttribute('data-target-percent') || "0";
            valueCircle.setAttribute('data-target-percent', targetPercent);
            
            // Store the calculated offset for the target percentage
            const targetOffset = calculateOffset(parseFloat(targetPercent), circumference);
            valueCircle.setAttribute('data-target-offset', targetOffset);
          }
        });
        
        // Listen for fragment shown events
        Reveal.addEventListener('fragmentshown', function(event) {
          // Get the fragment element that was shown
          const fragment = event.fragment;
          
          // Find all animation elements within this fragment
          const ringCircle = fragment.querySelector('.progress-ring-circle-value');
          const animateCount = fragment.querySelector('.animate-count');
          const multiplierProgress = fragment.querySelector('.multiplier-progress');
          const activeMarkers = fragment.querySelectorAll('.multiplier-marker.active');
          const currentMarker = fragment.querySelector('.multiplier-marker.current');
          const multiplierValue = fragment.querySelector('.multiplier-value');
          
          // Animate the progress ring
          if (ringCircle) {
            // Get the target percentage from the circle's data attribute
            const targetPercent = parseInt(ringCircle.getAttribute('data-target-percent') || "0");
            
            // Set the text content directly to ensure it displays the correct percentage
            const percentageEl = fragment.querySelector('.progress-percentage');
            if (percentageEl) {
              percentageEl.textContent = targetPercent + '%';
            }
            
            // Calculate the appropriate strokeDashoffset
            const circumference = parseFloat(ringCircle.getAttribute('data-circumference') || 2 * Math.PI * 20);
            const targetOffset = calculateOffset(targetPercent, circumference);
            
            // Apply the calculated offset and animation
            ringCircle.style.setProperty('--target-offset', targetOffset);
            
            // Important: Set initial position to full circle
            ringCircle.style.strokeDashoffset = circumference;
            
            // Force a reflow to ensure the animation starts properly
            void ringCircle.offsetWidth;
            
            // Now animate to the target percentage
            ringCircle.style.transition = "stroke-dashoffset 1.5s ease-out";
            ringCircle.style.strokeDashoffset = targetOffset;
          }
          
          // Animate the counter
          if (animateCount) {
            animateCount.classList.add('animate');
          }
          
          // Animate the multiplier progress bar
          if (multiplierProgress) {
            // Set the width based on the position of the current marker
            const container = fragment.querySelector('.multiplier-container');
            const currentMarkerIndex = Array.from(container.querySelectorAll('.multiplier-marker')).findIndex(m => m.classList.contains('current'));
            const totalMarkers = container.querySelectorAll('.multiplier-marker').length;
            
            if (currentMarkerIndex >= 0) {
              const progressWidth = (currentMarkerIndex + 1) / totalMarkers * 100;
              
              // Important: Reset width to 0 first
              multiplierProgress.style.width = '0%';
              
              // Force a reflow to ensure the animation starts properly
              void multiplierProgress.offsetWidth;
              
              // Set the target width as a custom property for animation
              multiplierProgress.style.setProperty('--target-width', `${progressWidth}%`);
              
              // Apply the animation and transition
              multiplierProgress.style.transition = "width 1.5s ease-out";
              multiplierProgress.style.width = `${progressWidth}%`;
            }
          }
          
          // Animate the active markers
          if (activeMarkers.length) {
            activeMarkers.forEach(marker => marker.classList.add('animate'));
          }
          
          // Animate the current marker
          if (currentMarker) {
            currentMarker.classList.add('animate');
          }
          
          // Animate the multiplier value
          if (multiplierValue) {
            // Ensure the value is visible
            multiplierValue.style.opacity = "1";
            multiplierValue.classList.add('animate');
          }
        });
        
        // Listen for fragment hidden events (to reset animations if needed)
        Reveal.addEventListener('fragmenthidden', function(event) {
          // Get the fragment element that was hidden
          const fragment = event.fragment;
          
          // Find all animation elements within this fragment
          const ringCircle = fragment.querySelector('.progress-ring-circle-value');
          const animateCount = fragment.querySelector('.animate-count');
          const multiplierProgress = fragment.querySelector('.multiplier-progress');
          const activeMarkers = fragment.querySelectorAll('.multiplier-marker.active');
          const currentMarker = fragment.querySelector('.multiplier-marker.current');
          const multiplierValue = fragment.querySelector('.multiplier-value');
          
          // Reset the progress ring animation
          if (ringCircle) {
            const circumference = parseFloat(ringCircle.getAttribute('data-circumference') || 2 * Math.PI * 20);
            ringCircle.style.strokeDashoffset = circumference; // Reset to 0%
            ringCircle.classList.remove('animate');
          }
          
          // Reset the counter animation
          if (animateCount) {
            animateCount.classList.remove('animate');
          }
          
          // Reset the multiplier progress animation
          if (multiplierProgress) {
            multiplierProgress.style.width = '0%';
            multiplierProgress.classList.remove('animate');
          }
          
          // Reset the active markers animation
          if (activeMarkers.length) {
            activeMarkers.forEach(marker => marker.classList.remove('animate'));
          }
          
          // Reset the current marker animation
          if (currentMarker) {
            currentMarker.classList.remove('animate');
          }
          
          // Reset the multiplier value animation
          if (multiplierValue) {
            multiplierValue.classList.remove('animate');
          }
        });
      });
    </script>
  </div>
</section>
